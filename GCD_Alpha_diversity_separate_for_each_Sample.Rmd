---
title: "Alpha Diversity Oral Tolerance Project"
author: "Rahul Bodkhe"
date: "May 23, 2019"
output: html_document
---

#Alpha Diversity
```{R}
library(ggplot2)
library(ape)
library(plyr)
library(vegan)
library(Biostrings)
library(RColorBrewer)
library(reshape2)
library(scales)
library(data.table)
library(dplyr)
library(phyloseq)
library(ggplot2)
library(data.table)
library(dplyr)
library(vegan)
library(RColorBrewer)
library(reshape2)
library(ggpubr)
```
##1. Alphadiversity in P histicola before and after
```{r}
rm(list = ls())
pseq1 <- readRDS("Gluten_Containing_Diet_qiime_Green_gene_final.rds")
pseq3 <- subset_samples(pseq1, Treatment!= "Media_A.Muc")
pseq4 <- subset_samples(pseq3, Treatment!= "Media_F.praus")
pseq7 <- subset_samples(pseq4, Treatment != c("F.prausnitzii"))
pseq12 <- subset_samples(pseq7, Treatment != c("A.Muciniphila")) 
pseq13 <- subset_samples(pseq12, Treatment != c(".NaÃ¯ve"))
pseq15 <- subset_samples(pseq13, Treatment != c(".PTD_Gliadin_Injected")) 
pseq15
pseq <- prune_taxa(taxa_sums(pseq15)>1, pseq15)
sample_data(pseq)
```


```{r}
my_comparisons1<- list(c("Mice_Sacrificed", "Experiment_Started"))
div.all <- estimate_richness(pseq)

alpha.ps1 <- plot_richness(pseq, x="Time_of_sampling", measures=c("Shannon")) + geom_boxplot(aes(fill=Treatment))

p1 <- alpha.ps1 + scale_fill_manual(values = c("#3399FF",  "#000099","#009900")) + theme(strip.background = element_rect(fill="white")) + ggtitle("Diversity of gut microbiota of GCD fed mice") + theme_bw(base_size = 12) + theme(plot.title = element_text(size = 12)) + theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) + facet_grid(cols = vars(Treatment)) + stat_compare_means(comparisons = my_comparisons1, method = "wilcox.test", size = 3)
print(p1)

ggsave("GCD_alpha_diverisity without naive at the end of the expt.tiff", height = 5, width = 7)
```



#withput p value
```{r}

alpha.ps1 <- plot_richness(pseq, x="Time_of_sampling", measures=c("Shannon")) + geom_boxplot(aes(fill=Treatment))

p1 <- alpha.ps1 + scale_fill_manual(values = c("#3399FF",  "#000099","#009900")) + theme(strip.background = element_rect(fill="white")) + ggtitle("Diversity of gut microbiota of GCD fed mice") + theme_bw(base_size = 12) + theme(plot.title = element_text(size = 12)) + theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) + facet_grid(cols = vars(Treatment)) 
p1
ggsave("GCD_Microbial diverisity without naive at the end of the expt without p value.tiff", height = 5, width = 7)
```


```{R}

pseq <- read.csv("alpha_div_div.all.csv")
pseq
my_comparisons1<- list(c("Experiment_Started", "Mice_Sacrificed") )

p <- ggplot(pseq, aes(y=Shannon, x=Time_of_sampling, fill= Treatment))+ 
    scale_fill_manual(values = c("#3399FF",  "#000099","#009900") ) + stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  
  geom_boxplot(outlier.shape=15) + theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) +  theme(panel.grid.minor = element_blank())+  theme(strip.background = element_rect(colour="black",  
                                       size=0.5))+ facet_grid(cols =  vars(Treatment))+theme(strip.text = element_text(size = 10, face="bold")) + ggtitle("Diversity of gut microbiota of GCD fed mice") 
p
ggsave("Prevotella naive_after_removing_outlier_from_p_melaninogenica.tiff", height = 5, width = 8 )
```
